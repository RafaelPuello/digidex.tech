{
  "$schema": "https://json-schema.org/draft-07/schema",
  "$id": "https://digidex.tech/ntags.schema.json",
  "title": "NFC Tags Application Model Schema",
  "description": "Models for managing NFC Tags.",
  "type": "object",
  "definitions": {
    "NFCTagDesign": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "maxLength": 255
        },
        "description": {
          "type": ["string", "null"]
        },
        "designer": {
          "type": ["string", "null"],
          "description": "Foreign key reference to User"
        },
        "uuid": {
          "type": "string",
          "format": "uuid"
        },
        "collection": {
          "type": ["string", "null"],
          "description": "Foreign key reference to Collection"
        }
      },
      "required": ["name", "uuid"]
    },
    "NFCTag": {
      "type": "object",
      "properties": {
        "serial_number": {
          "type": "string",
          "maxLength": 32
        },
        "integrated_circuit": {
          "type": "string",
          "enum": ["213", "215", "216"]
        },
        "user": {
          "type": ["string", "null"],
          "description": "Foreign key reference to User"
        },
        "design": {
          "type": ["string", "null"],
          "description": "Foreign key reference to NFCTagDesign"
        },
        "active": {
          "type": "boolean"
        }
      },
      "required": ["serial_number"]
    },
    "NFCTagScan": {
      "type": "object",
      "properties": {
        "ntag": {
          "type": "string",
          "description": "Foreign key reference to NFCTag"
        },
        "counter": {
          "type": "integer",
          "minimum": 0
        },
        "scanned_by": {
          "type": ["string", "null"],
          "description": "Foreign key reference to User"
        },
        "scanned_at": {
          "type": "string",
          "format": "date-time"
        }
      },
      "required": ["ntag", "counter", "scanned_at"]
    },
    "NFCTagEEPROM": {
      "type": "object",
      "properties": {
        "uuid": {
          "type": "string",
          "format": "uuid"
        },
        "ntag": {
          "type": "string",
          "description": "Foreign key reference to NFCTag"
        },
        "eeprom": {
          "type": "string",
          "contentEncoding": "base64",
          "maxLength": 2048
        },
        "created_at": {
          "type": "string",
          "format": "date-time"
        },
        "last_modified": {
          "type": "string",
          "format": "date-time"
        }
      },
      "required": ["uuid", "ntag", "eeprom", "created_at", "last_modified"]
    },
    "NFCTaggedItem": {
      "type": "object",
      "properties": {
        "nfc_tag": {
          "type": "string",
          "description": "Foreign key reference to NFCTag"
        },
        "content_type": {
          "type": "string",
          "description": "Foreign key reference to ContentType"
        },
        "object_id": {
          "type": "integer",
          "minimum": 1
        }
      },
      "required": ["nfc_tag", "content_type", "object_id"]
    }
  },
  "properties": {
    "ntags": { "$ref": "#/definitions/NFCTag" },
    "designs": { "$ref": "#/definitions/NFCTagDesign" },
    "scans": { "$ref": "#/definitions/NFCTagScan" },
    "eeproms": { "$ref": "#/definitions/NFCTagEEPROM" },
    "tagged_items": { "$ref": "#/definitions/NFCTaggedItem" }
  }
}
